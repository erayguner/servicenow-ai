# ISO/IEC 27001:2022 Compliance Framework for Amazon Bedrock Agents
# Information Security Management System (ISMS)

framework:
  name: 'ISO/IEC 27001'
  version: '2022'
  description: 'Information Security Management System requirements'
  scope: 'Amazon Bedrock Agents Infrastructure'
  certification_body: 'Accredited certification body required'

# Annex A Controls
controls:
  # A.5 Organizational Controls
  organizational:
    A.5.1:
      title: 'Policies for information security'
      objective: 'To provide management direction and support for information security'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Organizations'
          checks:
            - service_control_policies_defined
            - tag_policies_enforced
        - service: 'Security Hub'
          checks:
            - security_standards_enabled
            - compliance_status_tracked

    A.5.2:
      title: 'Information security roles and responsibilities'
      objective: 'To define and allocate information security responsibilities'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'IAM'
          checks:
            - roles_and_responsibilities_documented
            - separation_of_duties_enforced
        - service: 'Control Tower'
          checks:
            - account_factory_configured
            - guardrails_enabled

    A.5.3:
      title: 'Segregation of duties'
      objective: 'To reduce opportunities for unauthorized modification or misuse'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'IAM'
          checks:
            - no_single_user_full_permissions
            - privileged_access_separated
        - service: 'Bedrock'
          checks:
            - bedrock_admin_separate_from_user
            - knowledge_base_admin_separated

    A.5.7:
      title: 'Threat intelligence'
      objective: 'To ensure information security events are appropriately communicated'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'GuardDuty'
          checks:
            - threat_intelligence_feeds_enabled
            - findings_published_to_security_hub
        - service: 'Security Hub'
          checks:
            - third_party_integrations_enabled

    A.5.8:
      title: 'Information security in project management'
      objective: 'To integrate information security into project management'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Service Catalog'
          checks:
            - secure_portfolios_defined
            - security_baselines_enforced

    A.5.9:
      title: 'Inventory of information and other associated assets'
      objective: 'To identify assets to define appropriate protection responsibilities'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Config'
          checks:
            - resource_inventory_maintained
            - configuration_recorder_enabled
        - service: 'Systems Manager'
          checks:
            - inventory_collection_enabled
        - service: 'Bedrock'
          checks:
            - bedrock_agents_inventory_maintained
            - knowledge_bases_documented

    A.5.10:
      title: 'Acceptable use of information and other associated assets'
      objective: 'To ensure assets are used in accordance with policies'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Organizations'
          checks:
            - acceptable_use_policy_enforced
            - scp_prevents_unauthorized_actions

    A.5.12:
      title: 'Classification of information'
      objective: 'To ensure information receives appropriate level of protection'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Macie'
          checks:
            - data_classification_jobs_enabled
            - sensitive_data_discovered
        - service: 'Tags'
          checks:
            - classification_tags_applied
            - data_sensitivity_labeled
        - service: 'Bedrock'
          checks:
            - bedrock_knowledge_base_classified

    A.5.13:
      title: 'Labelling of information'
      objective: 'To develop and implement appropriate set of procedures'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Tags'
          checks:
            - resource_tagging_enforced
            - mandatory_tags_applied

    A.5.14:
      title: 'Information transfer'
      objective: 'To maintain security of information transfer'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'S3'
          checks:
            - s3_bucket_ssl_requests_only
            - transfer_acceleration_secure
        - service: 'Transfer Family'
          checks:
            - sftp_encryption_enforced

    A.5.15:
      title: 'Access control'
      objective: 'To ensure authorized access and prevent unauthorized access'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'IAM'
          checks:
            - least_privilege_enforced
            - access_policies_reviewed
        - service: 'Access Analyzer'
          checks:
            - external_access_findings_reviewed

    A.5.16:
      title: 'Identity management'
      objective: 'To manage full lifecycle of identities'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'IAM Identity Center'
          checks:
            - identity_center_configured
            - identity_lifecycle_managed
        - service: 'Cognito'
          checks:
            - user_pool_configured
            - identity_federation_enabled

    A.5.17:
      title: 'Authentication information'
      objective: 'To ensure authentication information is properly managed'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Secrets Manager'
          checks:
            - secrets_rotation_enabled
            - secrets_encrypted
        - service: 'IAM'
          checks:
            - access_keys_rotated
            - password_policy_enforced

    A.5.18:
      title: 'Access rights'
      objective: 'To ensure appropriate access rights are provisioned'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'IAM'
          checks:
            - access_rights_reviewed_periodically
            - unused_credentials_removed
        - service: 'Bedrock'
          checks:
            - bedrock_agent_access_reviewed

    A.5.23:
      title: 'Information security for use of cloud services'
      objective: 'To manage information security for cloud services'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Bedrock'
          checks:
            - bedrock_service_controls_configured
            - shared_responsibility_understood
        - service: 'Control Tower'
          checks:
            - landing_zone_configured

    A.5.30:
      title: 'ICT readiness for business continuity'
      objective: 'To ensure availability of ICT facilities'
      control_type: 'Organizational'
      aws_mappings:
        - service: 'Backup'
          checks:
            - backup_plan_configured
            - recovery_points_configured
        - service: 'Bedrock'
          checks:
            - bedrock_multi_region_deployment
            - bedrock_failover_configured

  # A.6 People Controls
  people:
    A.6.1:
      title: 'Screening'
      objective: 'To verify all candidates for employment are properly screened'
      control_type: 'People'
      aws_mappings:
        - service: 'IAM'
          checks:
            - background_verification_documented

    A.6.2:
      title: 'Terms and conditions of employment'
      objective: 'To ensure personnel understand their responsibilities'
      control_type: 'People'
      aws_mappings:
        - service: 'Documentation'
          checks:
            - security_responsibilities_documented
            - acceptable_use_acknowledged

    A.6.3:
      title: 'Information security awareness, education and training'
      objective: 'To ensure personnel are aware of information security responsibilities'
      control_type: 'People'
      aws_mappings:
        - service: 'AWS Training'
          checks:
            - security_training_completed
            - compliance_training_documented

    A.6.4:
      title: 'Disciplinary process'
      objective: 'To ensure violations are dealt with appropriately'
      control_type: 'People'
      aws_mappings:
        - service: 'CloudTrail'
          checks:
            - policy_violations_logged
            - disciplinary_actions_documented

    A.6.5:
      title: 'Responsibilities after termination or change of employment'
      objective: 'To protect organizational interests during employment changes'
      control_type: 'People'
      aws_mappings:
        - service: 'IAM'
          checks:
            - termination_procedures_defined
            - access_revocation_automated

    A.6.6:
      title: 'Confidentiality or non-disclosure agreements'
      objective: 'To protect confidential information'
      control_type: 'People'
      aws_mappings:
        - service: 'Documentation'
          checks:
            - ndas_signed_documented

    A.6.7:
      title: 'Remote working'
      objective: 'To ensure security when personnel work remotely'
      control_type: 'People'
      aws_mappings:
        - service: 'Client VPN'
          checks:
            - vpn_authentication_configured
            - vpn_logging_enabled
        - service: 'WorkSpaces'
          checks:
            - workspaces_encryption_enabled

  # A.7 Physical Controls
  physical:
    A.7.1:
      title: 'Physical security perimeters'
      objective: 'To prevent unauthorized physical access'
      control_type: 'Physical'
      aws_mappings:
        - service: 'AWS Shared Responsibility'
          checks:
            - aws_physical_security_reviewed

    A.7.2:
      title: 'Physical entry'
      objective: 'To ensure secure areas are protected'
      control_type: 'Physical'
      aws_mappings:
        - service: 'AWS Shared Responsibility'
          checks:
            - data_center_controls_verified

    A.7.4:
      title: 'Physical security monitoring'
      objective: 'To detect and prevent unauthorized physical access'
      control_type: 'Physical'
      aws_mappings:
        - service: 'AWS Compliance Reports'
          checks:
            - soc_reports_reviewed

    A.7.7:
      title: 'Clear desk and clear screen'
      objective: 'To reduce risks of unauthorized information access'
      control_type: 'Physical'
      aws_mappings:
        - service: 'WorkSpaces'
          checks:
            - auto_logout_configured
            - screen_lock_enforced

  # A.8 Technological Controls
  technological:
    A.8.1:
      title: 'User endpoint devices'
      objective: 'To ensure information on endpoint devices is protected'
      control_type: 'Technological'
      aws_mappings:
        - service: 'WorkSpaces'
          checks:
            - endpoint_encryption_enabled
            - device_compliance_enforced
        - service: 'Systems Manager'
          checks:
            - endpoint_patching_configured

    A.8.2:
      title: 'Privileged access rights'
      objective: 'To restrict and control allocation of privileged access rights'
      control_type: 'Technological'
      aws_mappings:
        - service: 'IAM'
          checks:
            - privileged_access_monitored
            - mfa_required_privileged_users
        - service: 'Bedrock'
          checks:
            - bedrock_admin_access_restricted

    A.8.3:
      title: 'Information access restriction'
      objective: 'To restrict access to information and systems'
      control_type: 'Technological'
      aws_mappings:
        - service: 'IAM'
          checks:
            - resource_based_policies_configured
            - least_privilege_access
        - service: 'Bedrock'
          checks:
            - bedrock_knowledge_base_access_restricted
            - bedrock_agent_iam_policies_minimal

    A.8.4:
      title: 'Access to source code'
      objective: 'To prevent unauthorized access to source code'
      control_type: 'Technological'
      aws_mappings:
        - service: 'CodeCommit'
          checks:
            - repository_access_controlled
            - approval_rules_configured
        - service: 'S3'
          checks:
            - code_buckets_private

    A.8.5:
      title: 'Secure authentication'
      objective: 'To ensure secure authentication technologies are implemented'
      control_type: 'Technological'
      aws_mappings:
        - service: 'IAM'
          checks:
            - mfa_enabled_all_users
            - strong_password_policy
        - service: 'Cognito'
          checks:
            - advanced_security_enabled
            - mfa_configured
        - service: 'Bedrock'
          checks:
            - bedrock_api_authentication_iam

    A.8.6:
      title: 'Capacity management'
      objective: 'To ensure adequate capacity to meet performance requirements'
      control_type: 'Technological'
      aws_mappings:
        - service: 'CloudWatch'
          checks:
            - capacity_metrics_monitored
            - scaling_alarms_configured
        - service: 'Bedrock'
          checks:
            - bedrock_quotas_monitored
            - throttling_configured

    A.8.7:
      title: 'Protection against malware'
      objective: 'To ensure information and systems are protected against malware'
      control_type: 'Technological'
      aws_mappings:
        - service: 'GuardDuty'
          checks:
            - malware_protection_enabled
            - threat_detection_active
        - service: 'Inspector'
          checks:
            - vulnerability_scanning_enabled

    A.8.8:
      title: 'Management of technical vulnerabilities'
      objective: 'To prevent exploitation of technical vulnerabilities'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Inspector'
          checks:
            - continuous_scanning_enabled
            - findings_remediated_timely
        - service: 'Systems Manager'
          checks:
            - patch_manager_configured
            - compliance_tracked

    A.8.9:
      title: 'Configuration management'
      objective: 'To establish and maintain security of system configurations'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Config'
          checks:
            - config_enabled_all_regions
            - configuration_baselines_enforced
        - service: 'Systems Manager'
          checks:
            - state_manager_associations
            - desired_state_enforced

    A.8.10:
      title: 'Information deletion'
      objective: 'To prevent unauthorized information disclosure or reuse'
      control_type: 'Technological'
      aws_mappings:
        - service: 'S3'
          checks:
            - object_lock_configured
            - mfa_delete_enabled
        - service: 'KMS'
          checks:
            - key_deletion_window_configured
        - service: 'Bedrock'
          checks:
            - bedrock_knowledge_base_deletion_protection

    A.8.11:
      title: 'Data masking'
      objective: 'To limit exposure of sensitive data'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Macie'
          checks:
            - sensitive_data_discovery_enabled
        - service: 'Bedrock'
          checks:
            - bedrock_pii_detection_enabled
            - bedrock_output_filtering_configured

    A.8.12:
      title: 'Data leakage prevention'
      objective: 'To detect and prevent unauthorized disclosure of information'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Macie'
          checks:
            - dlp_policies_configured
            - automated_discovery_enabled
        - service: 'GuardDuty'
          checks:
            - data_exfiltration_detection

    A.8.13:
      title: 'Information backup'
      objective: 'To protect against loss of data'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Backup'
          checks:
            - backup_plan_configured
            - backup_vault_locked
            - cross_region_copy_enabled
        - service: 'Bedrock'
          checks:
            - bedrock_knowledge_base_backup_enabled
            - bedrock_agent_config_versioned

    A.8.14:
      title: 'Redundancy of information processing facilities'
      objective: 'To ensure availability of information processing facilities'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Multi-Region'
          checks:
            - multi_region_deployment
            - failover_configured
        - service: 'Bedrock'
          checks:
            - bedrock_cross_region_replication

    A.8.15:
      title: 'Logging'
      objective: 'To record events and generate evidence'
      control_type: 'Technological'
      aws_mappings:
        - service: 'CloudTrail'
          checks:
            - cloudtrail_enabled_all_regions
            - log_file_validation_enabled
        - service: 'CloudWatch Logs'
          checks:
            - log_retention_configured
            - log_encryption_enabled
        - service: 'Bedrock'
          checks:
            - bedrock_invocation_logging_enabled
            - bedrock_model_invocation_logged

    A.8.16:
      title: 'Monitoring activities'
      objective: 'To detect anomalous behavior and security incidents'
      control_type: 'Technological'
      aws_mappings:
        - service: 'CloudWatch'
          checks:
            - anomaly_detection_configured
            - metric_filters_enabled
        - service: 'Security Hub'
          checks:
            - findings_aggregation_enabled
            - automated_response_configured
        - service: 'Bedrock'
          checks:
            - bedrock_usage_monitored
            - anomalous_invocations_detected

    A.8.17:
      title: 'Clock synchronization'
      objective: 'To ensure accuracy of audit logs'
      control_type: 'Technological'
      aws_mappings:
        - service: 'EC2'
          checks:
            - ntp_configured
            - time_synchronization_enabled

    A.8.18:
      title: 'Use of privileged utility programs'
      objective: 'To prevent use of programs that override system controls'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Systems Manager'
          checks:
            - privileged_commands_logged
            - session_manager_audit_enabled

    A.8.19:
      title: 'Installation of software on operational systems'
      objective: 'To prevent unauthorized software installation'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Systems Manager'
          checks:
            - approved_software_list
            - unauthorized_software_blocked

    A.8.20:
      title: 'Networks security'
      objective: 'To ensure protection of information in networks'
      control_type: 'Technological'
      aws_mappings:
        - service: 'VPC'
          checks:
            - security_groups_restrictive
            - network_acls_configured
            - vpc_flow_logs_enabled
        - service: 'Network Firewall'
          checks:
            - firewall_configured
            - intrusion_prevention_enabled

    A.8.21:
      title: 'Security of network services'
      objective: 'To ensure security of network services'
      control_type: 'Technological'
      aws_mappings:
        - service: 'VPC'
          checks:
            - vpc_endpoints_configured
            - privatelink_used
        - service: 'Bedrock'
          checks:
            - bedrock_vpc_endpoint_configured

    A.8.22:
      title: 'Segregation of networks'
      objective: 'To segregate groups of information services'
      control_type: 'Technological'
      aws_mappings:
        - service: 'VPC'
          checks:
            - subnet_isolation_implemented
            - network_segmentation_configured
        - service: 'Transit Gateway'
          checks:
            - route_tables_segregated

    A.8.23:
      title: 'Web filtering'
      objective: 'To manage access to external websites'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Network Firewall'
          checks:
            - domain_filtering_configured
            - url_filtering_enabled

    A.8.24:
      title: 'Use of cryptography'
      objective: 'To ensure proper use of cryptography'
      control_type: 'Technological'
      aws_mappings:
        - service: 'KMS'
          checks:
            - strong_algorithms_used
            - key_rotation_enabled
        - service: 'Bedrock'
          checks:
            - bedrock_encryption_at_rest
            - bedrock_encryption_in_transit

    A.8.25:
      title: 'Secure development life cycle'
      objective: 'To establish rules for secure system development'
      control_type: 'Technological'
      aws_mappings:
        - service: 'CodePipeline'
          checks:
            - security_testing_integrated
            - approval_stages_configured
        - service: 'CodeGuru'
          checks:
            - code_review_enabled
            - security_scanning_enabled

    A.8.26:
      title: 'Application security requirements'
      objective: 'To ensure security is designed into applications'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Bedrock'
          checks:
            - bedrock_guardrails_configured
            - input_validation_implemented
            - output_filtering_configured

    A.8.27:
      title: 'Secure system architecture and engineering principles'
      objective: 'To establish principles for engineering secure systems'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Well-Architected'
          checks:
            - security_pillar_reviewed
            - best_practices_implemented

    A.8.28:
      title: 'Secure coding'
      objective: 'To ensure secure coding principles are applied'
      control_type: 'Technological'
      aws_mappings:
        - service: 'CodeGuru'
          checks:
            - security_detectors_enabled
            - code_quality_monitored

    A.8.29:
      title: 'Security testing in development and acceptance'
      objective: 'To ensure security testing is part of SDLC'
      control_type: 'Technological'
      aws_mappings:
        - service: 'CodeBuild'
          checks:
            - security_testing_phase_included
            - sast_dast_integrated

    A.8.30:
      title: 'Outsourced development'
      objective: 'To ensure outsourced development is secure'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Artifact'
          checks:
            - third_party_compliance_verified

    A.8.31:
      title: 'Separation of development, test and production environments'
      objective: 'To reduce risks of unauthorized access or changes'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Organizations'
          checks:
            - separate_accounts_per_environment
            - scp_environment_isolation
        - service: 'Bedrock'
          checks:
            - bedrock_environments_separated

    A.8.32:
      title: 'Change management'
      objective: 'To ensure changes are controlled'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Config'
          checks:
            - change_tracking_enabled
            - drift_detection_configured
        - service: 'CloudFormation'
          checks:
            - change_sets_required

    A.8.33:
      title: 'Test information'
      objective: 'To ensure test data is protected'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Macie'
          checks:
            - test_data_sanitized
            - production_data_not_in_test

    A.8.34:
      title: 'Protection of information systems during audit testing'
      objective: 'To minimize impact of audit activities'
      control_type: 'Technological'
      aws_mappings:
        - service: 'Config'
          checks:
            - read_only_audit_access
            - audit_trails_protected

# ISMS Documentation Requirements
documentation:
  scope_statement:
    required: true
    content:
      - organizational_boundaries
      - applicable_business_units
      - aws_services_in_scope
      - bedrock_agents_coverage

  information_security_policy:
    required: true
    review_frequency: 'Annual'

  risk_assessment_methodology:
    required: true
    components:
      - asset_identification
      - threat_identification
      - vulnerability_assessment
      - impact_analysis
      - risk_evaluation

  statement_of_applicability:
    required: true
    content:
      - applicable_controls
      - excluded_controls_with_justification
      - implementation_status

  risk_treatment_plan:
    required: true
    options:
      - risk_modification
      - risk_retention
      - risk_avoidance
      - risk_sharing

  competence_evidence:
    required: true
    records:
      - training_records
      - certifications
      - qualifications

# Audit and Certification
audit:
  stage_1:
    focus: 'Documentation review'
    activities:
      - isms_documentation_review
      - scope_verification
      - readiness_assessment

  stage_2:
    focus: 'Implementation verification'
    activities:
      - on_site_assessment
      - control_effectiveness_testing
      - evidence_examination
      - aws_environment_review
      - bedrock_security_verification

  surveillance:
    frequency: 'Annual'
    focus: 'Continued compliance'

  recertification:
    frequency: 'Every 3 years'
    scope: 'Full reassessment'

# Automated Monitoring
automation:
  aws_config_rules:
    - rule_name: 'iso27001-encryption-at-rest'
      applicable_controls: ['A.8.24']

    - rule_name: 'iso27001-access-logging'
      applicable_controls: ['A.8.15']

    - rule_name: 'iso27001-network-segmentation'
      applicable_controls: ['A.8.22']

  continuous_monitoring:
    - security_hub_compliance_tracking
    - config_compliance_reporting
    - cloudwatch_security_metrics
    - bedrock_security_monitoring
