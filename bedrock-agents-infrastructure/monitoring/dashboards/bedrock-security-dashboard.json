{
  "DashboardName": "BedrockSecurityDashboard",
  "DashboardBody": {
    "widgets": [
      {
        "type": "metric",
        "x": 0,
        "y": 0,
        "width": 12,
        "height": 6,
        "properties": {
          "metrics": [
            [
              "AWS/SecurityHub",
              "ComplianceScore",
              {
                "stat": "Average",
                "label": "Overall Compliance Score"
              }
            ],
            [
              "AWS/GuardDuty",
              "FindingsCount",
              {
                "stat": "Sum",
                "label": "GuardDuty Findings",
                "dimensions": {
                  "Severity": "HIGH"
                }
              }
            ]
          ],
          "period": 300,
          "stat": "Average",
          "region": "eu-west-2",
          "title": "Security Posture Overview"
        }
      },
      {
        "type": "metric",
        "x": 12,
        "y": 0,
        "width": 12,
        "height": 6,
        "properties": {
          "metrics": [
            [
              "AWS/GuardDuty",
              "FindingsCount",
              {
                "stat": "Sum",
                "label": "Critical Findings",
                "dimensions": {
                  "Severity": "HIGH"
                }
              }
            ],
            [
              ".",
              "FindingsCount",
              {
                "stat": "Sum",
                "label": "Medium Findings",
                "dimensions": {
                  "Severity": "MEDIUM"
                }
              }
            ],
            [
              ".",
              "FindingsCount",
              {
                "stat": "Sum",
                "label": "Low Findings",
                "dimensions": {
                  "Severity": "LOW"
                }
              }
            ]
          ],
          "period": 300,
          "stat": "Sum",
          "region": "eu-west-2",
          "title": "GuardDuty Findings by Severity"
        }
      },
      {
        "type": "metric",
        "x": 0,
        "y": 6,
        "width": 8,
        "height": 6,
        "properties": {
          "metrics": [
            [
              "AWS/IAM",
              "FailedAuthenticationAttempts",
              {
                "stat": "Sum",
                "label": "Failed Auth Attempts"
              }
            ],
            [
              ".",
              "SuccessfulAuthenticationAttempts",
              {
                "stat": "Sum",
                "label": "Successful Auth"
              }
            ]
          ],
          "period": 300,
          "stat": "Sum",
          "region": "eu-west-2",
          "title": "Authentication Metrics"
        }
      },
      {
        "type": "metric",
        "x": 8,
        "y": 6,
        "width": 8,
        "height": 6,
        "properties": {
          "metrics": [
            [
              "AWS/CloudTrail",
              "IAMPolicyChanges",
              {
                "stat": "Sum",
                "label": "Policy Changes"
              }
            ],
            [
              ".",
              "SecurityGroupChanges",
              {
                "stat": "Sum",
                "label": "Security Group Changes"
              }
            ],
            [
              ".",
              "RoleAssumeFailures",
              {
                "stat": "Sum",
                "label": "Role Assume Failures"
              }
            ]
          ],
          "period": 300,
          "stat": "Sum",
          "region": "eu-west-2",
          "title": "Configuration Changes"
        }
      },
      {
        "type": "metric",
        "x": 16,
        "y": 6,
        "width": 8,
        "height": 6,
        "properties": {
          "metrics": [
            [
              "AWS/SecretsManager",
              "SecretAccessCount",
              {
                "stat": "Sum",
                "label": "Secrets Accessed"
              }
            ],
            [
              ".",
              "UnauthorizedSecretAccess",
              {
                "stat": "Sum",
                "label": "Unauthorized Access Attempts"
              }
            ]
          ],
          "period": 300,
          "stat": "Sum",
          "region": "eu-west-2",
          "title": "Secrets Manager Access"
        }
      },
      {
        "type": "metric",
        "x": 0,
        "y": 12,
        "width": 12,
        "height": 6,
        "properties": {
          "metrics": [
            [
              "AWS/WAF",
              "BlockedRequests",
              {
                "stat": "Sum",
                "label": "Blocked Requests",
                "dimensions": {
                  "WebACL": "BedrockAgentWAF"
                }
              }
            ],
            [
              ".",
              "AllowedRequests",
              {
                "stat": "Sum",
                "label": "Allowed Requests",
                "dimensions": {
                  "WebACL": "BedrockAgentWAF"
                }
              }
            ],
            [
              ".",
              "CountedRequests",
              {
                "stat": "Sum",
                "label": "Counted Requests",
                "dimensions": {
                  "WebACL": "BedrockAgentWAF"
                }
              }
            ]
          ],
          "period": 60,
          "stat": "Sum",
          "region": "eu-west-2",
          "title": "WAF Request Metrics"
        }
      },
      {
        "type": "metric",
        "x": 12,
        "y": 12,
        "width": 12,
        "height": 6,
        "properties": {
          "metrics": [
            [
              "AWS/KMS",
              "UserErrorCount",
              {
                "stat": "Sum",
                "label": "KMS User Errors"
              }
            ],
            [
              ".",
              "ThrottledCount",
              {
                "stat": "Sum",
                "label": "KMS Throttling Events"
              }
            ],
            [
              ".",
              "EncryptionOperations",
              {
                "stat": "Sum",
                "label": "Encryption Operations"
              }
            ],
            [
              ".",
              "DecryptionOperations",
              {
                "stat": "Sum",
                "label": "Decryption Operations"
              }
            ]
          ],
          "period": 300,
          "stat": "Sum",
          "region": "eu-west-2",
          "title": "KMS Encryption Operations"
        }
      },
      {
        "type": "log",
        "x": 0,
        "y": 18,
        "width": 24,
        "height": 6,
        "properties": {
          "query": "fields @timestamp, eventName, sourceIPAddress, userAgent, errorCode\n| filter eventName like /DeleteTrail|StopLogging|PutTrailEventSelectors/\n| stats count() as suspicious_events by sourceIPAddress, eventName",
          "region": "eu-west-2",
          "title": "Suspicious Security Events",
          "queryId": "suspicious-security-events"
        }
      }
    ]
  }
}
