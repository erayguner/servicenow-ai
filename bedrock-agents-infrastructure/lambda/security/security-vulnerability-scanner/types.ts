export interface ScanEvent {
  scanTypes?: ScanType[];
  lambdaFunctions?: string[];
  ecrRepositories?: string[];
  packageFiles?: string[];
  severityThreshold?: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
}

export type ScanType = 'LAMBDA' | 'DOCKER' | 'PACKAGES';

export interface ScanResult {
  scanId: string;
  timestamp: string;
  totalVulnerabilities: number;
  criticalCount: number;
  highCount: number;
  mediumCount: number;
  lowCount: number;
  vulnerabilities: Vulnerability[];
  scanDuration: number;
  scanTypes: ScanType[];
  remediationTicketsCreated: number;
}

export type Vulnerability = PackageVulnerability | ImageVulnerability;

export interface BaseVulnerability {
  id: string;
  title: string;
  description: string;
  severity: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW';
  cvssScore?: number;
  cveId?: string;
  publishedDate?: string;
  lastModifiedDate?: string;
  references?: string[];
  remediation?: string;
  riskScore: number;
}

export interface PackageVulnerability extends BaseVulnerability {
  type: 'PACKAGE';
  packageName: string;
  packageVersion: string;
  fixedVersion?: string;
  packageManager: 'npm' | 'pip' | 'maven' | 'gradle' | 'yarn' | 'gem' | 'composer';
  functionName?: string;
  filePath?: string;
}

export interface ImageVulnerability extends BaseVulnerability {
  type: 'IMAGE';
  imageUri: string;
  imageDigest: string;
  repositoryName: string;
  layerDigest?: string;
  packageName?: string;
  packageVersion?: string;
  fixedVersion?: string;
}

export interface DependencyScan {
  functionName: string;
  runtime: string;
  dependencies: PackageDependency[];
  vulnerabilities: PackageVulnerability[];
}

export interface PackageDependency {
  name: string;
  version: string;
  isDirect: boolean;
  isDevDependency: boolean;
}

export interface ImageScanResult {
  repositoryName: string;
  imageDigest: string;
  imageTags: string[];
  scanStatus: 'IN_PROGRESS' | 'COMPLETE' | 'FAILED';
  vulnerabilities: ImageVulnerability[];
  scanCompletedAt?: string;
}

export interface RemediationTicket {
  ticketId: string;
  scanId: string;
  vulnerability: Vulnerability;
  priority: 'P0' | 'P1' | 'P2' | 'P3';
  status: 'OPEN' | 'IN_PROGRESS' | 'RESOLVED' | 'WONT_FIX';
  createdAt: string;
}

export interface CVEDetails {
  cveId: string;
  cvssScore: number;
  cvssVector: string;
  severity: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW';
  description: string;
  publishedDate: string;
  lastModifiedDate: string;
  references: string[];
}

export interface LoggerContext {
  [key: string]: any;
}
